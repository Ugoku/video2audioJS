<!DOCTYPE html5>
<meta charset="UTF-8">
<title>workingtest</title>
<body>
<input type="file" onchange="read(this.files[0]);"/>
<button onclick="go();" disabled>Go!</button>
</body>
<script>
function read(file){
document.querySelector("button").setAttribute("disabled","");
var reader=new FileReader();
reader.addEventListener("load",function(){document.querySelector("button").removeAttribute("disabled");});
reader.readAsArrayBuffer(file);
}
function go(buffer){
  var offlineAudioContext = new OfflineAudioContext(numberOfChannels, sampleRate * duration, sampleRate);
  var soundSource = offlineAudioContext.createBufferSource();
  var videoFileAsBuffer = buffer; // arraybuffer
  audioContext.decodeAudioData(videoFileAsBuffer).then(function (decodedAudioData) {
    myBuffer = decodedAudioData;
    soundSource.buffer = myBuffer;
    soundSource.connect(offlineAudioContext.destination);
    soundSource.start();
    offlineAudioContext.startRendering().then(function (renderedBuffer) {
      console.log(renderedBuffer); // outputs audiobuffer
    }).catch(function (err) {
      console.log('Rendering failed: ' + err);
    });
  });
}
</script>
