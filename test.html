<!DOCTYPE html5>
<html>
<head>
<title>test</title>

</head>
<body>
<input type="file"/>
   <button onclick="go();">Go!</button>

<script>
function go(){
var input=document.querySelector("input");
function getBuffer(resolve) {
    var reader = new FileReader();
    reader.onload = function () {
        var arrayBuffer = reader.result;
        resolve(arrayBuffer);
    }
    reader.readAsArrayBuffer(fileData);
}
var audioContext = new(window.AudioContext || window.webkitAudioContext)();
fileData = new Blob([input.files[0]]);
var videoFileAsBuffer = new Promise(getBuffer);
videoFileAsBuffer.then(function (data) {
    audioContext.decodeAudioData(data).then(function (decodedAudioData) {
        var offlineAudioContext = new (webkitOfflineAudioContext||OfflineAudioContext)(2, 44100 * 100, 44100);
        var soundSource = offlineAudioContext.createBufferSource();
        mySoundBuffer = decodedAudioData;
        soundSource = audioContext.createBufferSource();
        soundSource.buffer = mySoundBuffer;
        // soundSource.connect(audioContext.destination);
        // soundSource.start();
        soundSource.connect(offlineAudioContext.destination);
        soundSource.start();
        offlineAudioContext.startRendering().then(function (renderedBuffer) {
        console.log(renderedBuffer); // outputs audiobuffer
        var song = audioContext.createBufferSource();
        song.buffer = renderedBuffer;
        song.connect(audioContext.destination);
        song.start();
        }).catch(function (err) {alert('Rendering failed: ' + err);});
    });
}
</script>
</body>
</html>
